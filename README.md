# 织梦者 (DreamWeaver)

欢迎来到织梦者项目！这是一个充满想象力和正能量的应用，旨在帮助用户将模糊的梦想变得具体、可见，并提供实现梦想的路径，激发用户实现目标的动力。

## 项目目的 (Project Purpose)

你是否曾对未来有过美好的憧憬？“织梦者”能将你的梦想和个人形象结合，生成一张你梦想成真时的“未来照片”。它不仅让你“看”到未来，还会为你提供一份实现梦想的行动指南和激励人心的寄语，让梦想不再遥远。

## 主要功能 (Features)

*   **未来可视化 (Visualize the Future):** 上传一张个人照片，描述你的梦想（例如“成为一名宇航员”），应用将生成一张你梦想成真时的人物形象图片。
*   **生成行动计划 (Actionable Plan):** AI 会根据你的梦想，为你量身定制一份包含3-5个关键步骤的行动计划，让实现路径更清晰。
*   **获取专属寄语 (Inspiring Message):** 获得一段温暖而有力的专属寄语，在你追梦的路上为你加油打气。
*   **一键分享梦想 (Share Your Dream):** 将生成的“未来照片”和文字计划合成为一张精美的分享图，并通过二维码轻松分享给朋友或社交网络。

## 实现途径 (How It Works)

本项目是一个基于Python Flask的Web应用，其核心实现分为前端、后端和AI生成三个部分。

### 前端 (Frontend)

*   **技术栈:** 使用基础的 HTML、Tailwind CSS 和原生 JavaScript 构建界面。
*   **页面:**
    *   `Home.html`: 项目的欢迎和介绍页面。
    *   `DreamCanvas.html`: 用户输入信息的核心界面，包括上传照片、填写姓名和梦想。
    *   `DreamViewer.html`: 展示AI生成结果的页面，包括“未来照片”和行动计划。
*   **Markdown渲染:** 使用 `marked.js` 库将后端返回的Markdown格式的行动计划实时渲染成带格式的HTML。

### 后端 (Backend)

*   **框架:** 使用 **Flask** 作为Web服务器，处理路由和业务逻辑。
*   **主要接口:**
    *   `/`: 渲染首页。
    *   `/dreamcanvas`: 渲染梦想输入页面。
    *   `/generate`: 接收用户上传的图片和梦想描述，调用AI模型进行处理，并返回结果页面。
    *   `/share`: 接收前端发来的分享请求，调用图片处理和分享模块，最终返回一个包含分享二维码的URL。

### 核心功能 (Core Functionality)

1.  **AI生成 (`generate.py`):**
    *   **模型:** 调用 **Google Gemini Pro (`gemini-2.5-flash-image`)** 多模态模型。
    *   **处理流程:** 将用户的照片和梦想描述文本作为Prompt的一部分，发送给Gemini API。API会返回一张新的人物图片和一段Markdown格式的文本（包含行动计划和寄语）。

2.  **分享图合成与分享 (`share.py`):**
    *   **图片合成:** 使用 **Pillow** 库。该模块接收生成的图片和Markdown文本，动态计算文本所需高度，然后创建一个新的画布，将图片和渲染后的文本（包括标题、列表等格式）绘制在一起，生成一张精美的分享图。
    *   **文件上传与分享:**
        *   使用 **WebDAV** 协议将合成的图片上传到 **Nextcloud** 服务器。
        *   调用Nextcloud的**OCS分享API**为上传的图片创建一个公开的分享链接。
        *   使用 **qrcode** 库根据该分享链接生成一个二维码。
        *   最终将二维码图片的URL返回给前端进行展示。

## TO DO

- [ ] 添加豆包api支持

- [ ] 打包成二进制文件

- [ ] 替换掉webdav分享为本地保存图片

- [ ] 做成小程序？？？